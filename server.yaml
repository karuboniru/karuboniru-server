include:
  - fedora-common-ostree.yaml
  - bootupd.yaml
ref: fedora/39/${basearch}/karuboniru-server

repos:
  - fedora-39
  - fedora-39-updates

packages:
  - NetworkManager-bluetooth
  - NetworkManager-l2tp
  - NetworkManager-libreswan
  - NetworkManager-openconnect
  - NetworkManager-vpnc
  - NetworkManager-wifi
  - abattis-cantarell-fonts
  - acl
  - alsa-sof-firmware
  - apcupsd
  - appstream-data
  - attr
  - bash-color-prompt
  - bat
  - bear
  - bind-utils
  - boost-devel
  - bootc
  - borgbackup
  - buildah
  - certbot
  - checksec
  - chrony
  - cifs-utils
  - cifs-utils-info
  - clang
  - clang-tools-extra
  - cmake
  - cmake-data
  - cockpit
  - cockpit-file-sharing
  - cockpit-kdump
  - cockpit-machines
  - cockpit-navigator
  - cockpit-pcp
  - cockpit-podman
  - cockpit-selinux
  - compsize
  - conntrack-tools
  - copr-cli
  - default-editor
  - dhcp-client
  - dos2unix
  - dracut-config-rescue
  - efibootmgr
  - eigen3-devel
  - firewalld
  - flexiblas-openblas-serial
  - flexiblas-openblas-serial64
  - flexiblas-openblas-threads
  - flexiblas-openblas-threads64
  - fpaste
  - fwupd
  - fwupd-plugin-flashrom
  - fwupd-plugin-modem-manager
  - fwupd-plugin-uefi-capsule-data
  - fzf
  - gawk-all-langpacks
  - gcc-gdb-plugin
  - gcc-gfortran
  - gdb
  - ghostscript
  - ghostscript-tools-fonts
  - ghostscript-tools-printing
  - git
  - perl-Git
  - glances
  - gnome-keyring
  - grub2-tools-efi
  - grub2-tools-extra
  - gsl-devel
  - gstreamer1-plugins-bad-free-libs
  - hdparm
  - htop
  - hunspell-en
  - iotop
  - iperf3
  - ipmitool
  - iptraf-ng
  - iptstate
  - irqbalance
  - iwlegacy-firmware
  - iwlwifi-dvm-firmware
  - iwlwifi-mvm-firmware
  - jwhois
  - kernel
  - kernel
  - kernel
  - kernel-modules-extra
  - kernel-modules-extra
  - kernel-modules-extra
  - kernel-tools
  - langpacks-zh_CN
  - lhapdf-devel
  - libXext-devel
  - libXft-devel
  - libXpm-devel
  - libasan
  - libdovi
  - libertas-firmware
  - libnsl2-devel
  - libtool
  - libubsan
  - liburing-devel
  - lm_sensors
  - log4cpp-devel
  - lsof
  - ltrace
  - man-pages
  - man-pages-zh-CN
  - mcelog
  - microcode_ctl
  - mtr
  - net-tools
  - nginx-mod-stream
  - ninja-build
  - nmap
  - ntfs2btrfs
  - numactl
  - nvme-cli
  - openblas-devel
  - opensc
  - openssh-server
  - openssl-devel
  - p7zip
  - pandoc
  - passwdqc
  - patchutils
  - pciutils
  - perf
  - perl-FindBin
  - perl-Unicode-Normalize
  - perl-YAML-Tiny
  - perl-sigtrap
  - pipewire-alsa
  - pipewire-pulseaudio
  - plymouth
  - plymouth-scripts
  - podman-docker
  - podman-plugins
  - powertop
  - pythia8-devel
  - python3-certbot-dns-cloudflare
  - python3-pwntools
  - python3-rangehttpserver
  - python3-root
  - qemu-kvm
  - radvd
  - rclone
  - remove-retired-packages
  - root-genvector
  - root-geom
  - root-gui-webgui6
  - root-hist-factory
  - root-minuit2
  - root-montecarlo-pythia8
  - root-netx
  - root-roofit-more
  - root-smatrix
  - root-spectrum
  - root-tutorial
  - root-unfold
  - rootfiles
  - rpm-ostree
  - rust2rpm
  - samba-client
  - setools-console
  - setserial
  - shim-x64
  - smartmontools
  - softnet-stat
  - sssd-kcm
  - strace
  - stress
  - sudo
  - sudo-python-plugin
  - systemd-oomd-defaults
  - systemd-container
  - targetcli
  - tbb-devel
  - tcpdump
  - time
  - tmux
  - toolbox
  - tpm2-pkcs11
  - tpm2-pkcs11-tools
  - traceroute
  - tree
  - udica
  - unar
  - usb_modeswitch
  - usb_modeswitch-data
  - usbutils
  - valgrind
  - vim-minimal
  - waypipe
  - whois
  - wireguard-tools
  - wol
  - words
  - xorg-x11-xauth
  - xrootd-client
  - xrootd-voms
  - zram-generator-defaults
  - zsh

postprocess:
  - |
    # Enable root login with simple password, to 
    # make sure user can get access after applying
    # image
    echo "root" | passwd --stdin root
    mkdir -p /etc/ssh/sshd_config.d
    echo "PasswordAuthentication no" > /etc/ssh/sshd_config.d/99-password-authentication.conf
    